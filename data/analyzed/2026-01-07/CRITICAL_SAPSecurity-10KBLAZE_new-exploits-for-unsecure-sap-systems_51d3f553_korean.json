{
  "id": "51d3f553-fc4c-41d8-95ae-545b7436741d",
  "title": "New Exploits for Unsecure SAP Systems",
  "url": "https://www.cisa.gov/news-events/cybersecurity-advisories/aa19-122a",
  "content": "<div>\n<h2><strong>Summary</strong></h2>\n</div>\n<p>The Cybersecurity and Infrastructure Security Agency (CISA) is issuing this activity alert in response to recently disclosed exploits that target unsecure configurations of SAP components. [<a href=\"https://github.com/msuiche/OPCDE/tree/master/2019/Emirates/(SAP)%20Gateway%20to%20Heaven%20-%20Dmitry%20Chastuhin%2C%20Mathieu%20Geli\" title=\"(SAP) Gateway to Heaven - Dmitry Chastuhin, Mathieu Geli\">1</a>]</p>\n<div>\n<h2><strong>Technical Details</strong></h2>\n</div>\n<p>A presentation at the April 2019 Operation for Community Development and Empowerment (OPCDE) cybersecurity conference describes SAP systems with unsecure configurations exposed to the internet. Typically, SAP systems are not intended to be exposed to the internet as it is an untrusted network. Malicious cyber actors can attack and compromise these unsecure systems with publicly available exploit tools, termed “10KBLAZE.” The presentation details the new exploit tools and reports on systems exposed to the internet.</p>\n<h3>SAP Gateway ACL</h3>\n<p>The SAP Gateway allows non-SAP applications to communicate with SAP applications. If SAP Gateway access control lists (ACLs) are not configured properly (e.g., gw/acl_mode = 0), anonymous users can run operating system (OS) commands.[2] According to the OPCDE presentation, about 900 U.S. internet-facing systems were detected in this vulnerable condition.</p>\n<h3>SAP Router secinfo</h3>\n<p>The SAP router is a program that helps connect SAP systems with external networks. The default <code>secinfo</code> configuration for a SAP Gateway allows any internal host to run OS commands anonymously. If an attacker can access a misconfigured SAP router, the router can act as an internal host and proxy the attacker’s requests, which may result in remote code execution.</p>\n<p>According to the OPCDE presentation, 1,181 SAP routers were exposed to the internet. It is unclear if the exposed systems were confirmed to be vulnerable or were simply running the SAP router service.</p>\n<h3>SAP Message Server</h3>\n<p>SAP Message Servers act as brokers between Application Servers (AS). By default, Message Servers listen on a port 39XX and have no authentication. If an attacker can access a Message Server, they can redirect and/or execute legitimate man-in-the-middle (MITM) requests, thereby gaining credentials. Those credentials can be used to execute code or operations on AS servers (assuming the attacker can reach them). According to the OPCDE presentation, there are 693 Message Servers exposed to the internet in the United States. The Message Server ACL must be protected by the customer in all releases.</p>\n<h3>Signature</h3>\n<p>CISA worked with security researchers from Onapsis Inc.[<a href=\"https://www.onapsis.com/\" title=\"Onapsis\">3</a>] to develop the following Snort signature that can be used to detect the exploits:</p>\n<p><code>alert tcp $EXTERNAL_NET any -&gt; $HOME_NET any (msg:\"10KBLAZE SAP Exploit execute attempt\"; flow:established,to_server; content:\"|06 cb 03|\"; offset:4; depth:3; content:\"SAPXPG_START_XPG\"; nocase; distance:0; fast_pattern; content:\"37D581E3889AF16DA00A000C290099D0001\"; nocase; distance:0; content:\"extprog\"; nocase; distance:0; sid:1; rev:1;)</code></p>\n<h2><strong>Mitigations</strong></h2>\n<p>CISA recommends administrators of SAP systems implement the following to mitigate the vulnerabilities included in the OPCDE presentation:</p>\n<ul>\n<li>Ensure a secure configuration of their SAP landscape.</li>\n<li>Restrict access to SAP Message Server.\n<ul>\n<li>Review SAP Notes 1408081 and 821875. Restrict authorized hosts via ACL files on Gateways (<code>gw/acl_mode </code>and <code>secinfo</code>) and Message Servers (<code>ms/acl_info</code>).[4], [5]</li>\n<li>Review SAP Note 1421005. Split MS internal/public:<code> rdisp/msserv=0 rdisp/msserv_internal=39NN</code>. [6]</li>\n<li>Restrict access to Message Server internal port (<code>tcp/39NN</code>) to clients or the internet.</li>\n<li>Enable Secure Network Communications (SNC) for clients.</li>\n</ul>\n</li>\n<li>Scan for exposed SAP components.\n<ul>\n<li>Ensure that SAP components are not exposed to the internet.</li>\n<li>Remove or secure any exposed SAP components.</li>\n</ul>\n</li>\n</ul>\n<div>\n<h2><strong>References</strong></h2>\n<p>[1] <a href=\"https://github.com/msuiche/OPCDE/tree/master/2019/Emirates/(SAP)%20Gateway%20to%20Heaven%20-%20Dmitry%20Chastuhin%2C%20Mathieu%20Geli\" title=\"(SAP) Gateway to Heaven - Dmitry Chastuhin, Mathieu Geli\">Comae Technologies: Operation for Community Development and Empowerment (OPCDE) Cybersecurity Conference Materials</a><br>[2] SAP: Gateway Access Control Lists<br>[3] <a href=\"https://www.onapsis.com\" title=\"Onapsis\">Onapsis Inc. website</a><br>[4] SAP Note 1408081<br>[5] SAP Note 821875<br>[6] SAP Note 1421005</p>\n<h2><strong>Revisions</strong></h2>\n</div>\n<p><strong>May 2, 2019:</strong> Initial version</p>\n",
  "source": "CISA US-CERT",
  "timestamp": "2026-01-06T23:11:11.826Z",
  "severity_score": 9,
  "severity_level": "CRITICAL",
  "is_pre_analyzed": true,
  "summary": "[Executive Overview] 미 국토안보부 산하 사이버보안 및 기간시설 안보국(CISA)은 '10KBLAZE'라고 알려진 공개 익스플로잇 도구를 통해 보안 설정이 취약한 SAP 구성 요소를 겨냥한 위협에 대해 긴급 경고를 발령했습니다. 본래 SAP 시스템은 인터넷에 직접 노출되어서는 안 되는 전사적 자원 관리(ERP) 핵심 시스템이지만, 잘못된 구성으로 인해 전 세계 수많은 기업의 자산이 원격 공격 위험에 처해 있습니다.\n\n[Threat Analysis] 주요 공격 벡터는 SAP Gateway, SAP Router, SAP Message Server의 구성 오류 및 접근 제어 목록(ACL) 설정 미흡에 기반합니다. 특히 SAP Gateway의 'gw/acl_mode' 설정이 0으로 되어 있을 경우 익명의 사용자가 운영체제(OS) 명령을 직접 실행할 수 있습니다. 또한 Message Server는 기본적으로 인증 없이 포트(39XX)가 개방되어 있어, 공격자가 중간자 공격(MITM)을 수행하고 자격 증명을 탈취하여 원격 코드 실행(RCE)으로 연결할 수 있는 구조적 취약점을 지니고 있습니다.\n\n[Impact Assessment] 이 공격이 성공할 경우 공격자는 기업의 재무 정보, 인사 기록, 공급망 데이터 등 핵심 비즈니스 데이터에 전적인 권한을 획득하게 됩니다. 이는 단순한 데이터 유출을 넘어 기업의 비즈니스 연속성을 심각하게 저해하고, 사기성 거래 수행이나 랜섬웨어 유포의 교두보로 활용될 수 있습니다. 조사에 따르면 미국 내에서만 약 2,000개 이상의 관련 구성 요소가 인터넷에 노출된 것으로 확인되어 광범위한 피해가 우려됩니다.\n\n[Recommendations] 보안 관리자는 즉시 모든 SAP 환경에 대해 인터넷 노출 여부를 점검하고, SAP Note 1408081 및 821875를 참고하여 Gateway 및 Message Server의 ACL(secinfo 및 ms/acl_info)을 강화해야 합니다. 또한 SNC(Secure Network Communications)를 활성화하여 통신 보안을 강화하고, 제공된 Snort 시그니처를 침입 탐지 시스템(IDS)에 적용하여 '10KBLAZE' 관련 공격 시도를 모니터링해야 합니다.",
  "tags": [
    "SAP Security",
    "10KBLAZE",
    "RCE",
    "ERP Security",
    "Configuration Management"
  ],
  "references": [
    "D. Chastuhin and M. Geli, (SAP) Gateway to Heaven, OPCDE Cybersecurity Conference, 2019",
    "CISA Alert (AA19-122A): New Exploits for Unsecure SAP Systems, 2019",
    "MITRE ATT&CK: T1190 (Exploit Public-Facing Application)",
    "SAP SE, SAP Security Note 1408081, SAP Support Portal, 2010",
    "Onapsis Research Labs, The 10KBLAZE Exploits: What You Need to Know, Industry Report, 2019"
  ],
  "is_analyzed": true
}