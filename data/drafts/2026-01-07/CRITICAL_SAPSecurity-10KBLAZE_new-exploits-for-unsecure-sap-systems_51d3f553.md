
# New Exploits for Unsecure SAP Systems

> [Executive Overview] 미 국토안보부 산하 사이버보안 및 기간시설 안보국(CISA)은 '10KBLAZE'라고 알려진 공개 익스플로잇 도구를 통해 보안 설정이 취약한 SAP 구성 요소를 겨냥한 위협에 대해 긴급 경고를 발령했습니다. 본래 SAP 시스템은 인터넷에 직접 노출되어서는 안 되는 전사적 자원 관리(ERP) 핵심 시스템이지만, 잘못된 구성으로 인해 전 세계 수많은 기업의 자산이 원격 공격 위험에 처해 있습니다.

[Threat Analysis] 주요 공격 벡터는 SAP Gateway, SAP Router, SAP Message Server의 구성 오류 및 접근 제어 목록(ACL) 설정 미흡에 기반합니다. 특히 SAP Gateway의 'gw/acl_mode' 설정이 0으로 되어 있을 경우 익명의 사용자가 운영체제(OS) 명령을 직접 실행할 수 있습니다. 또한 Message Server는 기본적으로 인증 없이 포트(39XX)가 개방되어 있어, 공격자가 중간자 공격(MITM)을 수행하고 자격 증명을 탈취하여 원격 코드 실행(RCE)으로 연결할 수 있는 구조적 취약점을 지니고 있습니다.

[Impact Assessment] 이 공격이 성공할 경우 공격자는 기업의 재무 정보, 인사 기록, 공급망 데이터 등 핵심 비즈니스 데이터에 전적인 권한을 획득하게 됩니다. 이는 단순한 데이터 유출을 넘어 기업의 비즈니스 연속성을 심각하게 저해하고, 사기성 거래 수행이나 랜섬웨어 유포의 교두보로 활용될 수 있습니다. 조사에 따르면 미국 내에서만 약 2,000개 이상의 관련 구성 요소가 인터넷에 노출된 것으로 확인되어 광범위한 피해가 우려됩니다.

[Recommendations] 보안 관리자는 즉시 모든 SAP 환경에 대해 인터넷 노출 여부를 점검하고, SAP Note 1408081 및 821875를 참고하여 Gateway 및 Message Server의 ACL(secinfo 및 ms/acl_info)을 강화해야 합니다. 또한 SNC(Secure Network Communications)를 활성화하여 통신 보안을 강화하고, 제공된 Snort 시그니처를 침입 탐지 시스템(IDS)에 적용하여 '10KBLAZE' 관련 공격 시도를 모니터링해야 합니다.

**Severity**: CRITICAL (9/10)
**Tags**: SAP Security, 10KBLAZE, RCE, ERP Security, Configuration Management

## Analysis
[Executive Overview] 미 국토안보부 산하 사이버보안 및 기간시설 안보국(CISA)은 '10KBLAZE'라고 알려진 공개 익스플로잇 도구를 통해 보안 설정이 취약한 SAP 구성 요소를 겨냥한 위협에 대해 긴급 경고를 발령했습니다. 본래 SAP 시스템은 인터넷에 직접 노출되어서는 안 되는 전사적 자원 관리(ERP) 핵심 시스템이지만, 잘못된 구성으로 인해 전 세계 수많은 기업의 자산이 원격 공격 위험에 처해 있습니다.

[Threat Analysis] 주요 공격 벡터는 SAP Gateway, SAP Router, SAP Message Server의 구성 오류 및 접근 제어 목록(ACL) 설정 미흡에 기반합니다. 특히 SAP Gateway의 'gw/acl_mode' 설정이 0으로 되어 있을 경우 익명의 사용자가 운영체제(OS) 명령을 직접 실행할 수 있습니다. 또한 Message Server는 기본적으로 인증 없이 포트(39XX)가 개방되어 있어, 공격자가 중간자 공격(MITM)을 수행하고 자격 증명을 탈취하여 원격 코드 실행(RCE)으로 연결할 수 있는 구조적 취약점을 지니고 있습니다.

[Impact Assessment] 이 공격이 성공할 경우 공격자는 기업의 재무 정보, 인사 기록, 공급망 데이터 등 핵심 비즈니스 데이터에 전적인 권한을 획득하게 됩니다. 이는 단순한 데이터 유출을 넘어 기업의 비즈니스 연속성을 심각하게 저해하고, 사기성 거래 수행이나 랜섬웨어 유포의 교두보로 활용될 수 있습니다. 조사에 따르면 미국 내에서만 약 2,000개 이상의 관련 구성 요소가 인터넷에 노출된 것으로 확인되어 광범위한 피해가 우려됩니다.

[Recommendations] 보안 관리자는 즉시 모든 SAP 환경에 대해 인터넷 노출 여부를 점검하고, SAP Note 1408081 및 821875를 참고하여 Gateway 및 Message Server의 ACL(secinfo 및 ms/acl_info)을 강화해야 합니다. 또한 SNC(Secure Network Communications)를 활성화하여 통신 보안을 강화하고, 제공된 Snort 시그니처를 침입 탐지 시스템(IDS)에 적용하여 '10KBLAZE' 관련 공격 시도를 모니터링해야 합니다.


## References
1. D. Chastuhin and M. Geli, (SAP) Gateway to Heaven, OPCDE Cybersecurity Conference, 2019
2. CISA Alert (AA19-122A): New Exploits for Unsecure SAP Systems, 2019
3. MITRE ATT&CK: T1190 (Exploit Public-Facing Application)
4. SAP SE, SAP Security Note 1408081, SAP Support Portal, 2010
5. Onapsis Research Labs, The 10KBLAZE Exploits: What You Need to Know, Industry Report, 2019
## Original Source
[CISA US-CERT](https://www.cisa.gov/news-events/cybersecurity-advisories/aa19-122a)
    